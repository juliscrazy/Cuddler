{% extends 'base.html' %}


{% block main %}

<main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4"><div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;"><div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div></div>
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
      <h1 class="h2">Stats</h1>
    </div>
    
    <div class="content">
      <div class="content_box">
        <div class="content_inner">
          <div class="colums">
            <div class="chartContainer">
              <span class="chartTitle">
                  Message activity over the last 30 days
              </span>
              <canvas id="serverMessageActivityChartMonth" width="200px" height="100px"></canvas>
                <script>
                  var ctx = document.getElementById("serverMessageActivityChartMonth").getContext("2d");
                  data = {{ monthdata|tojson }}
                  convertedData = []
                  data.forEach(eatShit)
                  function eatShit(value, index, array) {
                    convertedData.push({x: new Date(value.x * 1000), y: value.y})
                  }
                  var serverMessageActivityChartMonth = new Chart(ctx, {
                      type: 'line',
                      data: {"datasets":[{
                        fill: true,
                        label:"Messages",
                        borderColor : "#e4a075",
                        backgroundColor: "rgba(255, 255, 255, 0.2)",
                        data: convertedData,
                        cubicInterpolationMode: "monotone",
                        fill:false,
                        lineTension:1}]},
                      options: {
                        responsive: true,
                        defaultFontColor: "#fff",
                        legend: {
                          display: false
                        },
                        layout: {
                          padding: {
                            top: 10
                          }
                        },
                        scales: {
                          xAxes: [{
                            gridLines: {
                              display:false
                            },
                            ticks: {
                              fontColor: "#999"
                            },
                            type: 'time',
                              time: {
                                unit: "week",
                                tooltipFormat: "DD.MM.YYYY",
                                isoWeekday: true,
                                displayFormats: {
                                }
                              }
                          }],
                          yAxes: [{
                            display: false,
                            gridLines: {
                              display:false
                            }
                          }]
                        }
                      }
                  });
                  serverMessageActivityChartMonth.canvas.parentNode.style.width = '49%';
                  serverMessageActivityChartMonth.canvas.parentNode.style.padding = '0% 2% 0% 0%';
                </script>
            </div>
            <div class="chartContainer">
              <span class="chartTitle">
                Message activity over the last year
              </span>
              <canvas id="serverMessageActivityChartYear" width="200px" height="100px"></canvas>
                <script>
                  var ctx = document.getElementById("serverMessageActivityChartYear").getContext("2d");
                  data = {{ yeardata|tojson }}
                  convertedData = []
                  data.forEach(eatShit)
                  function eatShit(value, index, array) {
                    convertedData.push({x: new Date(value.x * 1000), y: value.y})
                  }
                  console.log(convertedData)
                  var serverMessageActivityChartYear = new Chart(ctx, {
                      type: 'line',
                      data: {"datasets":[{
                        fill: true,
                        label:"Messages",
                        borderColor : "#e4a075",
                        backgroundColor: "rgba(255, 255, 255, 0.2)",
                        data: convertedData,
                        cubicInterpolationMode: "monotone",
                        fill:false,
                        lineTension:1}]},
                      options: {
                        responsive: true,
                        defaultFontColor: "#fff",
                        legend: {
                          display: false
                        },
                        layout: {
                          padding: {
                            top: 10
                          }
                        },
                        scales: {
                          xAxes: [{
                            gridLines: {
                              display:false
                            },
                            ticks: {
                              fontColor: "#999"
                            },
                            type: 'time',
                              time: {
                                unit: "month",
                                tooltipFormat: "DD.MM.YYYY",
                                isoWeekday: true,
                              }
                          }],
                          yAxes: [{
                            display: false,
                            gridLines: {
                              display:false
                            }
                          }]
                        }
                      }
                  });
                  serverMessageActivityChartYear.canvas.parentNode.style.width = '49%';
                  serverMessageActivityChartYear.canvas.parentNode.style.padding = '0% 0% 0% 2%';
                </script>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
</div>
{% endblock %}